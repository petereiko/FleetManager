@model FleetManager.Business.DataObjects.DriverDutyOfCareDto
@using FleetManager.Business.Enums
@{
    Layout = null;
}
<style>
    .duty-care-details {
        max-height: 75vh;
        overflow-y: auto;
    }

        .duty-care-details .bg-gradient-primary {
            background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);
        }

        .duty-care-details .bg-purple {
            background-color: #6f42c1;
        }

        .duty-care-details .bg-orange {
            background-color: #fd7e14;
        }

        .duty-care-details .icon-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .duty-care-details .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
        }

        .duty-care-details .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .duty-care-details .status-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .duty-care-details .status-warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .duty-care-details .notes-content {
            background-color: #f8f9fa;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border-left: 3px solid #4e73df;
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .duty-care-details .card {
            transition: all 0.2s ease-in-out;
            border-radius: 0.75rem;
        }

            .duty-care-details .card:hover {
                transform: translateY(-1px);
                box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
            }

        .duty-care-details .card-header {
            border-radius: 0.75rem 0.75rem 0 0 !important;
            border-bottom: none;
        }

        .duty-care-details .fs-7 {
            font-size: 0.875rem;
        }

        .duty-care-details .compliance-item,
        .duty-care-details .audit-item {
            padding: 0.5rem;
            background-color: #f8f9fa;
            border-radius: 0.5rem;
            border: 1px solid #e9ecef;
        }

        .duty-care-details .fatigue-info > div {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e9ecef;
        }

            .duty-care-details .fatigue-info > div:last-child {
                border-bottom: none;
            }

        /* Scrollbar styling */
        .duty-care-details::-webkit-scrollbar {
            width: 6px;
        }

        .duty-care-details::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .duty-care-details::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

            .duty-care-details::-webkit-scrollbar-thumb:hover {
                background: #a8a8a8;
            }
</style>



    <div class="duty-care-details p-3">
        <!-- Header Section -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="card border-0 bg-gradient-primary text-white">
                    <div class="card-body py-3">
                        <div class="row align-items-center">
                            <div class="col-8">
                                <h6 class="mb-1 fw-bold">
                                    <i class="fas fa-clipboard-check me-2"></i>
                                    @{
                                        var recordTypeDisplay = Model.DutyOfCareRecordType switch
                                        {
                                            DutyOfCareRecordType.HealthCheck => "Health Check",
                                            DutyOfCareRecordType.SafetyTraining => "Safety Training",
                                            DutyOfCareRecordType.LicenceRenewal => "License Renewal",
                                            DutyOfCareRecordType.DrugTest => "Drug Test",
                                            DutyOfCareRecordType.VisionTest => "Vision Test",
                                            DutyOfCareRecordType.ComplianceAudit => "Compliance Audit",
                                            DutyOfCareRecordType.VehicleSafetyBriefing => "Vehicle Safety Briefing",
                                            _ => "Other"
                                        };
                                    }
                                    @recordTypeDisplay Record
                                </h6>
                                <small class="opacity-75">
                                    Record #@Model.Id • @Model.Date.ToString("MMMM dd, yyyy") at @Model.DeclarationTimestamp.ToString("HH:mm")
                                </small>
                            </div>
                            <div class="col-4 text-end">
                                @{
                                    var (statusClass, statusText) = Model.DutyOfCareStatus switch
                                    {
                                        DriverDutyOfCareStatus.Compliant => ("success", "Compliant"),
                                        DriverDutyOfCareStatus.PendingReview => ("warning", "Pending Review"),
                                        DriverDutyOfCareStatus.ActionRequired => ("danger", "Action Required"),
                                        DriverDutyOfCareStatus.Expired => ("secondary", "Expired"),
                                        DriverDutyOfCareStatus.UpcomingRenewal => ("info", "Upcoming Renewal"),
                                        DriverDutyOfCareStatus.Approved => ("success", "Approved"),
                                        _ => ("secondary", "Unknown")
                                    };
                                }
                                <span class="badge bg-@statusClass fs-6 px-3 py-2 shadow-sm">
                                    @statusText
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Key Participants Section -->
        <div class="row g-3 mb-3">
            <!-- Driver Card -->
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body p-3">
                        <div class="d-flex align-items-center">
                            <div class="icon-circle bg-primary me-3">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1 fw-bold text-dark">@Model.DriverName</h6>
                                <small class="text-muted">Driver ID: @Model.DriverId</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vehicle Card -->
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body p-3">
                        <div class="d-flex align-items-center">
                            <div class="icon-circle bg-info me-3">
                                <i class="fas fa-car text-white"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1 fw-bold text-dark">@Model.VehicleDescription</h6>
                                <small class="text-muted">Vehicle Plate No: @Model.LicensePlate</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Sections -->
        <div class="row g-3 mb-3">
            <!-- Health & Fitness -->
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-header bg-success text-white py-2">
                        <h6 class="mb-0 fw-bold fs-7">
                            <i class="fas fa-heartbeat me-2"></i>Health & Fitness
                        </h6>
                    </div>
                    <div class="card-body p-3">
                        <div class="status-item">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="text-muted">Fit to Drive</span>
                                <span class="status-badge @(Model.IsFitToDrive ? "status-success" : "status-danger")">
                                    <i class="fas @(Model.IsFitToDrive ? "fa-check" : "fa-times") me-1"></i>
                                    @(Model.IsFitToDrive ? "Yes" : "No")
                                </span>
                            </div>
                        </div>

                        @if (!string.IsNullOrEmpty(Model.HealthDeclarationNotes))
                        {
                            <div class="notes-section mt-3">
                                <label class="form-label fw-bold text-muted">Health Notes:</label>
                                <div class="notes-content">
                                    @Model.HealthDeclarationNotes
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Vehicle Responsibility -->
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-header bg-info text-white py-2">
                        <h6 class="mb-0 fw-bold fs-7">
                            <i class="fas fa-tools me-2"></i>Vehicle Responsibility
                        </h6>
                    </div>
                    <div class="card-body p-3">
                        <div class="status-item">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="text-muted">Pre-Check Completed</span>
                                <span class="status-badge @(Model.VehiclePreCheckCompleted ? "status-success" : "status-danger")">
                                    <i class="fas @(Model.VehiclePreCheckCompleted ? "fa-check" : "fa-times") me-1"></i>
                                    @(Model.VehiclePreCheckCompleted ? "Yes" : "No")
                                </span>
                            </div>
                        </div>

                        @if (!string.IsNullOrEmpty(Model.VehicleConditionNotes))
                        {
                            <div class="notes-section mt-3">
                                <label class="form-label fw-bold text-muted">Vehicle Notes:</label>
                                <div class="notes-content">
                                    @Model.VehicleConditionNotes
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Legal Compliance Section -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-warning text-dark py-2">
                        <h6 class="mb-0 fw-bold fs-7">
                            <i class="fas fa-balance-scale me-2"></i>Legal Compliance
                        </h6>
                    </div>
                    <div class="card-body p-3">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="compliance-item">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="text-muted small">Valid License</span>
                                        <span class="status-badge @(Model.HasValidLicense ? "status-success" : "status-danger")">
                                            <i class="fas @(Model.HasValidLicense ? "fa-check" : "fa-times")"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="compliance-item">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="text-muted small">Policy Awareness</span>
                                        <span class="status-badge @(Model.IsAwareOfCompanyPolicies ? "status-success" : "status-danger")">
                                            <i class="fas @(Model.IsAwareOfCompanyPolicies ? "fa-check" : "fa-times")"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="compliance-item">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="text-muted small">Hours Reviewed</span>
                                        <span class="status-badge @(Model.HasReviewedDrivingHours ? "status-success" : "status-danger")">
                                            <i class="fas @(Model.HasReviewedDrivingHours ? "fa-check" : "fa-times")"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Fatigue Management -->
        <div class="row g-3 mb-3">
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-header bg-purple text-white py-2">
                        <h6 class="mb-0 fw-bold fs-7">
                            <i class="fas fa-bed me-2"></i>Fatigue Management
                        </h6>
                    </div>
                    <div class="card-body p-3">
                        <div class="fatigue-info">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="text-muted">Reports Fatigue</span>
                                <span class="status-badge @(Model.ReportsFatigue ? "status-warning" : "status-success")">
                                    <i class="fas @(Model.ReportsFatigue ? "fa-exclamation-triangle" : "fa-check") me-1"></i>
                                    @(Model.ReportsFatigue ? "Yes" : "No")
                                </span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="text-muted">Last Rest Period</span>
                                <span class="fw-bold text-dark">
                                    @{
                                        var hours = Model.LastRestPeriod.Hours;
                                        var minutes = Model.LastRestPeriod.Minutes;
                                    }
                                    @hours h @minutes m
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Issues & Hazards -->
            <div class="col-md-6">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-header bg-orange text-white py-2">
                        <h6 class="mb-0 fw-bold fs-7">
                            <i class="fas fa-exclamation-triangle me-2"></i>Issues & Hazards
                        </h6>
                    </div>
                    <div class="card-body p-3">
                        <div class="status-item">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="text-muted">Vehicle Issues</span>
                                <span class="status-badge @(Model.ReportsVehicleIssues ? "status-warning" : "status-success")">
                                    <i class="fas @(Model.ReportsVehicleIssues ? "fa-exclamation-triangle" : "fa-check") me-1"></i>
                                    @(Model.ReportsVehicleIssues ? "Yes" : "No")
                                </span>
                            </div>
                        </div>

                        @if (!string.IsNullOrEmpty(Model.ReportedIssuesDetails))
                        {
                            <div class="notes-section mt-2">
                                <label class="form-label fw-bold text-muted small">Issue Details:</label>
                                <div class="notes-content small">
                                    @Model.ReportedIssuesDetails
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Declaration & Audit Trail -->
        <div class="row">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-secondary text-white py-2">
                        <h6 class="mb-0 fw-bold fs-7">
                            <i class="fas fa-signature me-2"></i>Declaration & Audit Trail
                        </h6>
                    </div>
                    <div class="card-body p-3">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="audit-item">
                                    <small class="text-muted d-block">Declaration Confirmed</small>
                                    <span class="status-badge @(Model.ConfirmsAccuracyOfInfo ? "status-success" : "status-danger")">
                                        <i class="fas @(Model.ConfirmsAccuracyOfInfo ? "fa-check" : "fa-times") me-1"></i>
                                        @(Model.ConfirmsAccuracyOfInfo ? "Confirmed" : "Not Confirmed")
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="audit-item">
                                    <small class="text-muted d-block">Created By</small>
                                    <span class="fw-bold text-dark small">@Model.CreatedBy</span>
                                    <small class="text-muted d-block">@Model.CreatedAt.ToString("MMM dd, yyyy HH:mm")</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                @if (Model.ModifiedDate.HasValue)
                                {
                                    <div class="audit-item">
                                        <small class="text-muted d-block">Last Modified</small>
                                        <span class="fw-bold text-dark small">@Model.ModifiedBy</span>
                                        <small class="text-muted d-block">@Model.ModifiedDate.Value.ToString("MMM dd, yyyy HH:mm")</small>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



